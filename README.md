# Плейлисты Rutube
Плейлист Rutube - встраиваемый виджет, позволяющий воспроизводить предопределеный набор роликов с сайта [rutube.ru](http://rutube.ru) на сторонних ресурсах. Создать плейлист Rutube и разместить его на своем сайте или блоге может любой пользователь интернета.

# Содержание
1. Общие сведения
2. Шаблон плейлиста
3. Параметры плейлиста
4. Ширина и высота плейлиста

## Общие сведения
Плейлист Rutube - встраиваемый виджет, который позволяет размещать контент Rutube на сторонних сайтах, включая сериалы и передачи каналов ТНТ, Пятница, РЕН-ТВ, мульфильмы производства Союзмульфильм и Disney, множество другого лицензионного контента, а также ролики любого пользователя сайта [rutube.ru](http://rutube.ru). Плейлист может работать на любой площадке, которая разрешает использование тега `<iframe>`: сайты, форумы, блоги. Для размещения плейлиста достаточно разместить код для встраивания, в котором будут указаны необходимый набор роликов, а также ширина и высота плейлиста. Опционально, для интеграции плейлиста с дизайном сайта можно задать ему собственную цветовую схему.

## Шаблон плейлиста
Код для встраивания плейлиста представляет собой HTML-тег `<iframe>`, который ссылается на страницу на сайте rutube.ru. Шаблон кода для встраивания плейлиста выглядит следующим образом:
```html
<iframe width="680px" height="508px" src="http://rutube.ru/playlist/?playlist=" frameborder="0" scrolling="no" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe>
```
где:

`width` - ширина плейлиста;

`height` - высота плейлиста;

`src` - адрес специальной страницы на сайте rutube.ru, которая отображает плейлист;

`frameborder` - ширина рамки тега `<iframe>` (указывается "ноль" для ее скрытия);

`scrolling` - скрытие полос прокрутки тега `<iframe>`;

`mozallowfullscreen`, `webkitallowfullscreen`, `allowfullscreen` - инструкции, разрешающие роликам из плейлиста разворачиваться на полный экран.

По-сути, этот готовый шаблон уже может быть встроен на сайт, однако, в нем будет отсутствовать контент, и на месте плейлиста пользователи увидят пустое пространство. Для отображения контента необходимо передать в атрибут `src` дополнительные параметры.

## Параметры плейлиста
Параметры, определящие что именно будет отображаться в плейлисте, передаются ему в виде пар `"ключ": "значение"`, перечисляемым через запятую. Такой формат записи параметров известен как [JSON](https://ru.wikipedia.org/wiki/JSON).

Пример записи параметров в формате JSON:
```json
{ "id": "123", "name": "John" }
```
или в более удобной форме:
```json
{
    "id": "123",
    "name": "John"
}
```
В этом примере двум вымышленным параметрам с названиями `"id"` и `"name"` присваиваются значения `"123"` и `"John"` соотвественно.

Кроме простых значений, вроде `"John"`, параметрам можно передавать _списки_. Для этого элементы списка необходимо перечислить через запятую и заключить в квадратные скобки:
```json
{
    "id": "123",
    "names": [ "John", "Jack", "Mary" ]
}
```
или в более удобной форме:
```json
{
    "id": "123",
    "names": [
        "John",
        "Jack",
        "Mary"
    ]
}
```
Здесь параметру `"names"` передается список из имен `"John"`, `"Jack"`, `"Mary"`.

В списках, в свою очередь, помимо простых значений вроде `"John"`, можно также передавать пары `"ключ": "значение"`:
```json
{
    "id": "123",
    "names": [
        { "name": "John", "gender": "male" },
        { "name": "Jack", "gender": "male" },
        { "name": "Mary", "gender": "female" }
    ]
}
```
Именно в таком формате - через списки пар `"ключ": "значение"` - передаются параметры для плейлиста Rutube.

Для описания источников, которые будут использованы в плейлисте, используется следующая форма записи:
```json
{
    "id": "28",
    "type": "tv"
}
```
где:

`"id"` - id источника;

`"type"` - тип источника.

Опционально, вместе с источником можно передать параметр `"name"`, в котором можно указать его альтернативное название:
```json
{
    "id": "28",
    "type": "tv",
    "name": "Мой любимый сериал Интерны"
}
```

В данный момент для использования в плейлистах доступно четыре типа источников:

`"tv"` - ТВ-шоу;

`"person"` - персоны;

`"tag"` - теги;

`"user"` - пользователи.

Минимальным требованием для отображения плейлиста является передача хотя бы одного источника в списке `"feeds"`:
```json
{
    "feeds": [{"id": "28", "type": "tv"}]
}
```

В данном случае в плейлист будет передан сериал "Интерны", и лента плейлиста будет состоять из роликов этого сериала.

Полученные параметры необходимо закодировать через специальный конвертер. Для предыдущего примера результат кодирования будет выглядеть следующим образом:
```
%7B%22feeds%22%3A%5B%7B%22id%22%3A%2228%22%2C%22type%22%3A%22tv%22%7D%5D%7D
```

Здесь не стоит пугаться большого количества символов вроде `%` - это лишь безопасный формат записи специальных символов, содержащихся в параметрах, где `%7B` соответствует скобке `{`, `%22` соответвует кавычкам `"` и так далее.

Полученный результат необходимо добавить к атрибуту `src` в шаблоне плейлиста (сразу после `playlist=`):
```json
<iframe width="680px" height="508px" src="http://rutube.ru/playlist/?playlist=%7B%22feeds%22%3A%5B%7B%22id%22%3A%2228%22%2C%22type%22%3A%22tv%22%7D%5D%7D" frameborder="0" scrolling="no" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe>
```

**После добавления закодированных параметров плейлист становится работоспособным и может быть размещен на сайте.** Однако, для наилучшей интеграции с сайтом плейлисту желательно задать подходящую ширину и высоту, речь о которых пойдет ниже.

Для создания плейлиста, содержащим несколько источников, необходимо добавить их к списку `"feeds"` через запятую:
```json
{
    "feeds": [
        { "id": "28", "type": "tv" },
        { "id": "1368", "type": "tv" }
    ]
}
```

В этом примере будет создан плейлист с сериалами "Интерны" и "Физрук". Кроме того, теперь в плейлисте будет отображаться меню вкладок, в котором можно выбрать конкретный сериал. Меню появляется автоматически, когда в плейлисте содержится больше одного источника.

Помимо этого, источники с типом `"tv"` (ТВ-шоу) поддерживают группировку по сезонам, которые можно передать в необязательном параметре `"params"`:
```json
{
    "feeds": [{
        "id": "28",
        "type": "tv",
        "name": "Интерны. Сезон 1",
        "params": {
            "season": "1"
        }
    }, {
        "id": "1368",
        "type": "tv",
        "name": "Интерны. Сезон 2",
        "params": {
            "season": "2"
        }
    }]
}
```

В этом примере будет создан плейлист, содержащий первый и второй сезоны сериала "Интерны".
